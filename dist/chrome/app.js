(()=>{var e={625:function(e,r,t){var n,s,a=t(625);"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self&&self,void 0===(s="function"==typeof(n=function(e){"use strict";if(void 0===window.browser||Object.getPrototypeOf(window.browser)!==Object.prototype||Object.getPrototypeOf(a)!==Object.prototype){const r="The message port closed before a response was received.",t="Returning a Promise is the preferred way to send a reply from an onMessage/onMessageExternal listener, as the sendResponse will be removed from the specs (See https://developer.mozilla.org/docs/Mozilla/Add-ons/WebExtensions/API/runtime/onMessage)",n=e=>{const n={alarms:{clear:{minArgs:0,maxArgs:1},clearAll:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getAll:{minArgs:0,maxArgs:0}},bookmarks:{create:{minArgs:1,maxArgs:1},get:{minArgs:1,maxArgs:1},getChildren:{minArgs:1,maxArgs:1},getRecent:{minArgs:1,maxArgs:1},getSubTree:{minArgs:1,maxArgs:1},getTree:{minArgs:0,maxArgs:0},move:{minArgs:2,maxArgs:2},remove:{minArgs:1,maxArgs:1},removeTree:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1},update:{minArgs:2,maxArgs:2}},browserAction:{disable:{minArgs:0,maxArgs:1,fallbackToNoCallback:!0},enable:{minArgs:0,maxArgs:1,fallbackToNoCallback:!0},getBadgeBackgroundColor:{minArgs:1,maxArgs:1},getBadgeText:{minArgs:1,maxArgs:1},getPopup:{minArgs:1,maxArgs:1},getTitle:{minArgs:1,maxArgs:1},openPopup:{minArgs:0,maxArgs:0},setBadgeBackgroundColor:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setBadgeText:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setIcon:{minArgs:1,maxArgs:1},setPopup:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setTitle:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},browsingData:{remove:{minArgs:2,maxArgs:2},removeCache:{minArgs:1,maxArgs:1},removeCookies:{minArgs:1,maxArgs:1},removeDownloads:{minArgs:1,maxArgs:1},removeFormData:{minArgs:1,maxArgs:1},removeHistory:{minArgs:1,maxArgs:1},removeLocalStorage:{minArgs:1,maxArgs:1},removePasswords:{minArgs:1,maxArgs:1},removePluginData:{minArgs:1,maxArgs:1},settings:{minArgs:0,maxArgs:0}},commands:{getAll:{minArgs:0,maxArgs:0}},contextMenus:{remove:{minArgs:1,maxArgs:1},removeAll:{minArgs:0,maxArgs:0},update:{minArgs:2,maxArgs:2}},cookies:{get:{minArgs:1,maxArgs:1},getAll:{minArgs:1,maxArgs:1},getAllCookieStores:{minArgs:0,maxArgs:0},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}},devtools:{inspectedWindow:{eval:{minArgs:1,maxArgs:2,singleCallbackArg:!1}},panels:{create:{minArgs:3,maxArgs:3,singleCallbackArg:!0},elements:{createSidebarPane:{minArgs:1,maxArgs:1}}}},downloads:{cancel:{minArgs:1,maxArgs:1},download:{minArgs:1,maxArgs:1},erase:{minArgs:1,maxArgs:1},getFileIcon:{minArgs:1,maxArgs:2},open:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},pause:{minArgs:1,maxArgs:1},removeFile:{minArgs:1,maxArgs:1},resume:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1},show:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},extension:{isAllowedFileSchemeAccess:{minArgs:0,maxArgs:0},isAllowedIncognitoAccess:{minArgs:0,maxArgs:0}},history:{addUrl:{minArgs:1,maxArgs:1},deleteAll:{minArgs:0,maxArgs:0},deleteRange:{minArgs:1,maxArgs:1},deleteUrl:{minArgs:1,maxArgs:1},getVisits:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1}},i18n:{detectLanguage:{minArgs:1,maxArgs:1},getAcceptLanguages:{minArgs:0,maxArgs:0}},identity:{launchWebAuthFlow:{minArgs:1,maxArgs:1}},idle:{queryState:{minArgs:1,maxArgs:1}},management:{get:{minArgs:1,maxArgs:1},getAll:{minArgs:0,maxArgs:0},getSelf:{minArgs:0,maxArgs:0},setEnabled:{minArgs:2,maxArgs:2},uninstallSelf:{minArgs:0,maxArgs:1}},notifications:{clear:{minArgs:1,maxArgs:1},create:{minArgs:1,maxArgs:2},getAll:{minArgs:0,maxArgs:0},getPermissionLevel:{minArgs:0,maxArgs:0},update:{minArgs:2,maxArgs:2}},pageAction:{getPopup:{minArgs:1,maxArgs:1},getTitle:{minArgs:1,maxArgs:1},hide:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setIcon:{minArgs:1,maxArgs:1},setPopup:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setTitle:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},show:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},permissions:{contains:{minArgs:1,maxArgs:1},getAll:{minArgs:0,maxArgs:0},remove:{minArgs:1,maxArgs:1},request:{minArgs:1,maxArgs:1}},runtime:{getBackgroundPage:{minArgs:0,maxArgs:0},getPlatformInfo:{minArgs:0,maxArgs:0},openOptionsPage:{minArgs:0,maxArgs:0},requestUpdateCheck:{minArgs:0,maxArgs:0},sendMessage:{minArgs:1,maxArgs:3},sendNativeMessage:{minArgs:2,maxArgs:2},setUninstallURL:{minArgs:1,maxArgs:1}},sessions:{getDevices:{minArgs:0,maxArgs:1},getRecentlyClosed:{minArgs:0,maxArgs:1},restore:{minArgs:0,maxArgs:1}},storage:{local:{clear:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}},managed:{get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1}},sync:{clear:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}}},tabs:{captureVisibleTab:{minArgs:0,maxArgs:2},create:{minArgs:1,maxArgs:1},detectLanguage:{minArgs:0,maxArgs:1},discard:{minArgs:0,maxArgs:1},duplicate:{minArgs:1,maxArgs:1},executeScript:{minArgs:1,maxArgs:2},get:{minArgs:1,maxArgs:1},getCurrent:{minArgs:0,maxArgs:0},getZoom:{minArgs:0,maxArgs:1},getZoomSettings:{minArgs:0,maxArgs:1},goBack:{minArgs:0,maxArgs:1},goForward:{minArgs:0,maxArgs:1},highlight:{minArgs:1,maxArgs:1},insertCSS:{minArgs:1,maxArgs:2},move:{minArgs:2,maxArgs:2},query:{minArgs:1,maxArgs:1},reload:{minArgs:0,maxArgs:2},remove:{minArgs:1,maxArgs:1},removeCSS:{minArgs:1,maxArgs:2},sendMessage:{minArgs:2,maxArgs:3},setZoom:{minArgs:1,maxArgs:2},setZoomSettings:{minArgs:1,maxArgs:2},update:{minArgs:1,maxArgs:2}},topSites:{get:{minArgs:0,maxArgs:0}},webNavigation:{getAllFrames:{minArgs:1,maxArgs:1},getFrame:{minArgs:1,maxArgs:1}},webRequest:{handlerBehaviorChanged:{minArgs:0,maxArgs:0}},windows:{create:{minArgs:0,maxArgs:1},get:{minArgs:1,maxArgs:2},getAll:{minArgs:0,maxArgs:1},getCurrent:{minArgs:0,maxArgs:1},getLastFocused:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},update:{minArgs:2,maxArgs:2}}};if(0===Object.keys(n).length)throw new Error("api-metadata.json has not been included in browser-polyfill");class s extends WeakMap{constructor(e,r){super(r),this.createItem=e}get(e){return this.has(e)||this.set(e,this.createItem(e)),super.get(e)}}const a=(r,t)=>(...n)=>{e.runtime.lastError?r.reject(new Error(e.runtime.lastError.message)):t.singleCallbackArg||n.length<=1&&!1!==t.singleCallbackArg?r.resolve(n[0]):r.resolve(n)},o=e=>1==e?"argument":"arguments",i=(e,r,t)=>new Proxy(r,{apply:(r,n,s)=>t.call(n,e,...s)});let l=Function.call.bind(Object.prototype.hasOwnProperty);const g=(e,r={},t={})=>{let n=Object.create(null),s={has:(r,t)=>t in e||t in n,get(s,m,d){if(m in n)return n[m];if(!(m in e))return;let c=e[m];if("function"==typeof c)if("function"==typeof r[m])c=i(e,e[m],r[m]);else if(l(t,m)){let r=((e,r)=>function(t,...n){if(n.length<r.minArgs)throw new Error(`Expected at least ${r.minArgs} ${o(r.minArgs)} for ${e}(), got ${n.length}`);if(n.length>r.maxArgs)throw new Error(`Expected at most ${r.maxArgs} ${o(r.maxArgs)} for ${e}(), got ${n.length}`);return new Promise(((s,o)=>{if(r.fallbackToNoCallback)try{t[e](...n,a({resolve:s,reject:o},r))}catch(a){console.warn(`${e} API method doesn't seem to support the callback parameter, falling back to call it without a callback: `,a),t[e](...n),r.fallbackToNoCallback=!1,r.noCallback=!0,s()}else r.noCallback?(t[e](...n),s()):t[e](...n,a({resolve:s,reject:o},r))}))})(m,t[m]);c=i(e,e[m],r)}else c=c.bind(e);else if("object"==typeof c&&null!==c&&(l(r,m)||l(t,m)))c=g(c,r[m],t[m]);else{if(!l(t,"*"))return Object.defineProperty(n,m,{configurable:!0,enumerable:!0,get:()=>e[m],set(r){e[m]=r}}),c;c=g(c,r[m],t["*"])}return n[m]=c,c},set:(r,t,s,a)=>(t in n?n[t]=s:e[t]=s,!0),defineProperty:(e,r,t)=>Reflect.defineProperty(n,r,t),deleteProperty:(e,r)=>Reflect.deleteProperty(n,r)},m=Object.create(e);return new Proxy(m,s)},m=e=>({addListener(r,t,...n){r.addListener(e.get(t),...n)},hasListener:(r,t)=>r.hasListener(e.get(t)),removeListener(r,t){r.removeListener(e.get(t))}}),d=new s((e=>"function"!=typeof e?e:function(r){const t=g(r,{},{getContent:{minArgs:0,maxArgs:0}});e(t)}));let c=!1;const A=new s((e=>"function"!=typeof e?e:function(r,n,s){let a,o,i=!1,l=new Promise((e=>{a=function(r){c||(console.warn(t,(new Error).stack),c=!0),i=!0,e(r)}}));try{o=e(r,n,a)}catch(e){o=Promise.reject(e)}const g=!0!==o&&((m=o)&&"object"==typeof m&&"function"==typeof m.then);var m;if(!0!==o&&!g&&!i)return!1;return(g?o:l).then((e=>{s(e)}),(e=>{let r;r=e&&(e instanceof Error||"string"==typeof e.message)?e.message:"An unexpected error occurred",s({__mozWebExtensionPolyfillReject__:!0,message:r})})).catch((e=>{console.error("Failed to send onMessage rejected reply",e)})),!0})),u=({reject:t,resolve:n},s)=>{e.runtime.lastError?e.runtime.lastError.message===r?n():t(new Error(e.runtime.lastError.message)):s&&s.__mozWebExtensionPolyfillReject__?t(new Error(s.message)):n(s)},p=(e,r,t,...n)=>{if(n.length<r.minArgs)throw new Error(`Expected at least ${r.minArgs} ${o(r.minArgs)} for ${e}(), got ${n.length}`);if(n.length>r.maxArgs)throw new Error(`Expected at most ${r.maxArgs} ${o(r.maxArgs)} for ${e}(), got ${n.length}`);return new Promise(((e,r)=>{const s=u.bind(null,{resolve:e,reject:r});n.push(s),t.sendMessage(...n)}))},h={devtools:{network:{onRequestFinished:m(d)}},runtime:{onMessage:m(A),onMessageExternal:m(A),sendMessage:p.bind(null,"sendMessage",{minArgs:1,maxArgs:3})},tabs:{sendMessage:p.bind(null,"sendMessage",{minArgs:2,maxArgs:3})}},E={clear:{minArgs:1,maxArgs:1},get:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}};return n.privacy={network:{"*":E},services:{"*":E},websites:{"*":E}},g(e,h,n)};if("object"!=typeof chrome||!chrome||!chrome.runtime||!chrome.runtime.id)throw new Error("This script should only be loaded in a browser extension.");e.exports=n(chrome)}else e.exports=a})?n.apply(r,[e]):n)||(e.exports=s)}},r={};function t(n){var s=r[n];if(void 0!==s)return s.exports;var a=r[n]={exports:{}};return e[n].call(a.exports,a,a.exports,t),a.exports}t.d=(e,r)=>{for(var n in r)t.o(r,n)&&!t.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:r[n]})},t.o=(e,r)=>Object.prototype.hasOwnProperty.call(e,r);var n={};(()=>{"use strict";t.d(n,{Nm:()=>N,r3:()=>j,Ho:()=>B,w3:()=>U,Em:()=>q,P_:()=>L,Zg:()=>k,lm:()=>I,ps:()=>H,zX:()=>F,o1:()=>$,uQ:()=>G,hk:()=>P});class e{constructor(r,t){this.threadId=r.getAttribute("data-id"),this.postId=e.maybeGetPostId(r),this.message=e.maybeGetThreadText(r),this.replyCount=e.maybeGetReplyCount(r),this.postTime=e.maybeGetPostTime(r),this.upvoteCount=e.maybeGetUpvoteCount(r),this.downvoteCount=e.maybeGetDownvoteCount(r),this.imageUrl=e.maybeGetThreadImage(r),this.hasPoll=e.maybeGetThreadPoll(r),this.postDeleted=e.isPostDeleted(r),this.manifest=null,this.isAnimeImage=null,this.senderTabId=null,this.masterTabId=null==t?null:parseInt(t)}static maybeGetThreadText(e){try{return e.querySelector(".message").innerHTML.replace(/<\/?[^>]+(>|$)/g,"").replaceAll("&gt;","").trim().replaceAll(/(\r\n|\n|\r)/gm,"")}catch(e){return"Thread was already removed"}}static maybeGetThreadPoll(e){try{return null!=e.querySelector(".icon-chart-bars")}catch(e){return!1}}static maybeGetPostId(e){try{return e.querySelector(".icon-pointer-upright").getAttribute("data-id")}catch(e){return null}}static maybeGetReplyCount(e){try{return e.querySelector(".thread-meta").firstElementChild.innerText}catch(e){return null}}static maybeGetUpvoteCount(e){try{return e.getElementsByClassName("post-vote upvote")[0].innerText}catch(e){return 0}}static maybeGetDownvoteCount(e){try{return e.getElementsByClassName("post-vote downvote")[0].innerText}catch(e){return 0}}static maybeGetPostTime(e){try{return e.querySelector(".thread-meta").lastElementChild.innerText}catch(e){return null}}static isPostDeleted(e){try{return null!=e.querySelector(".post-deleted")}catch(e){return!1}}static maybeGetThreadImage(e){try{return e.querySelector("img").getAttribute("src")}catch(e){return null}}}const r=e,s=Object.freeze({INIT:"init",THREADS:"threads",HIDE_THREAD:"hideThread",UNHIDE_THREAD:"unHideThread",SEND_THREADS_TO_ANOTHER_TAB:"sendThreadsToAnotherTab",AM_I_SPAWNED:"amISpawned",FETCH_THREADS_FROM_OTHER_PAGES:"fetchThreadsFromOtherPages",REQUEST_CACHED_THREADS:"requestCachedThreads",ASK_FOR_MESSAGES:"askForMessages",CLEAR_STORE:"clearStore",GET_SYNC_ID:"getSyncId",ADD_TAG:"addTag",ACQUIRE_SYNC_ID:"acquireSyncId",PAIR_DEVICE:"pairDevice",START_SYNC:"startSync",RESET_DB:"resetDb"}),a=Object.freeze({INIT_COMPLETE:"initComplete",INIT_FAILED:"initFailed",UNKNOWN_MESSAGE:"unknownMessage",FAILED_THREAD:"failedThread",WHITELISTED_THREAD:"whitelistedThread",IMAGE_SCAN_START:"imageScanStart",IMAGE_SCAN_FINISHED:"imageScanFinished",IMAGE_SCAN_OVER:"imageScanOver",YOU_A_SPAWN_BRO:"youASpawnBro",NAH_YOU_LEGIT_BRO:"nahYouLegitBro",THREAD_FROM_OTHER_PAGE:"threadFromOtherPage",UNREAD_MESSAGE:"unreadMessage",NEW_SYNC_ID:"newSyncId",PAIR_RESULT:"pairResult",SYNC_LOG:"syncLog"}),o=Object.freeze({GENERATE_MANIFEST:"generateManifest",IMAGE_PROCESSOR:"imageProcessor",ATTACH_MANIFEST:"attachManifest",TEXT_PROCESSOR:"textProcessor",REPORT_FAILED_THREAD:"reportFailedThread",REPORT_WHITELISTED_THREAD:"reportWhitelistedThread",NEXT_STEP:"nextStep",ADD_TO_ANIME_IMAGE_THREAD_DB:"addThreadToDb",CHECK_IF_THREAD_HAS_BEEN_HIDDEN:"checkIfThreadHasBeenHidden",OPENCV:"openCV",REPORT_IMAGE_SCAN:"reportImageScan",REPORT_IMAGE_SCAN_FINISHED:"reportImageScanFinished",REPORT_IMAGE_SCAN_OVER:"reportImageScanOver",PUSH_TO_FETCH_QUEUE:"pushToFetchQueue",ADD_TO_HIDE_DB:"addToHideDb",ADD_TO_WHITELIST_DB:"addToWhitelistDb",REMOVE_FROM_HIDE_DB:"removeFromHideDb",REMOVE_FROM_WHITELIST_DB:"removeFromWhitelistDb",HIDE_THREAD:"hideThread",WHITELIST_THREAD:"whitelistThread",FETCH_CACHED_THREADS:"fetchCachedThreads",REFRESH_CACHE:"refreshCache",ADD_THREAD_TO_CACHE:"addThreadToCache",SEND_TO_MASTER_TAB:"sendToMasterTab",REQUEST_UNREAD_MESSAGES:"requestUnreadMessages",RETURN_UNREAD_MESSAGES:"returnUnreadMessages",SHOW_UNREAD_MESSAGE:"showUnreadMessage",CREATE_MESSAGE_MODAL:"createMessageModal",MARK_MESSAGE_AS_READ:"markMessageAsRead",CLEAR_STORE:"clearStore",ADD_TAG_TO_DB:"addTagToDb"}),i=(Object.freeze({ADD_TAG:"addTag"}),o),l="ylilautaThreadHider",g="ylilautaThreadHiderToggler",m="ylilautaThreadHiderVersion",d="ylilautaThreadHiderMessageModal",c="ylilautaThreadLoader",A="messageModalTopPriorityContainer",u="messageModalLowPriorityContainer";function p(e){let r=e.childNodes;for(let e=0;e<r.length;e++){let t=r[e];t.nodeType==Node.TEXT_NODE?(t.parentNode.removeChild(t),e--):t.nodeType==Node.ELEMENT_NODE&&p(t)}}var h=t(625);var E=t(625);const x=e=>{e?(document.querySelector("#"+g).classList.add("threadHiderDisabled"),document.querySelector("#"+g).innerHTML="OFF"):(document.querySelector("#"+g).classList.remove("threadHiderDisabled"),document.querySelector("#"+g).innerHTML="ON")};var b=t(625);function y(){if(q())return;const e=U().length;G(!0),b.runtime.sendMessage({type:s.REQUEST_CACHED_THREADS,payload:{latestPage:e?U()[e-1]+1:2}}),F(e?U()[e-1]+1:2),document.querySelector("#"+c).classList.add("loaderVisible")}var T=t(625);function f(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,n)}return t}function S(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?f(Object(t),!0).forEach((function(r){_(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):f(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}function _(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}let v={},w=[],D=!1,C=[],R=null;const H=(()=>{const e={};return{publish:function(r,t){Array.isArray(e[r])&&e[r].forEach((e=>{e(t)}))},subscribe:function(r,t){Array.isArray(e[r])||(e[r]=[]),e[r].push(t)}}})();let O=[],M=!0;const I=()=>v,N=(e,r)=>v[e]=r,k=()=>M,P=e=>{M=e},L=()=>R,q=()=>D,G=e=>{D=e},U=()=>C,F=e=>C.push(e),j=e=>{e.preventDefault();try{const r=e.explicitOriginalTarget.getAttribute("data-id");e.stopPropagation(),B(e.explicitOriginalTarget,r)}catch(r){try{const r=e.path[0].getAttribute("data-id");e.stopPropagation(),B(e.path[0],r)}catch(e){}}},B=(e,r)=>{let t=e.parentNode.parentNode.classList;t.contains("visibleHiddenThread")?(T.runtime.sendMessage({type:s.UNHIDE_THREAD,payload:r}),t.remove("visibleHiddenThread")):T.runtime.sendMessage({type:s.HIDE_THREAD,payload:r})};(async()=>{R=await T.storage.sync.get(),console.log(R),T.runtime.sendMessage({type:s.INIT,payload:R})})(),[...document.getElementsByClassName("icon-minus")].map((e=>{e.addEventListener("click",j)}));const W=()=>{const e=R.sleepLength;return new Promise((r=>setTimeout(r,Number.isInteger(e)&&e>-1?e:0)))},$=(e,r)=>{T.storage.sync.get().then((function(t){T.storage.sync.set(S(S({},t),{},{[e]:r}))}))},z=(e,t)=>Array.prototype.slice.call(e).map((e=>new r(e,t)));window.setTimeout((()=>{O=document.querySelectorAll(".thread"),(e=>{v={};for(const r of e)v[r.getAttribute("data-id")]=r})(O),T.runtime.sendMessage({type:s.AM_I_SPAWNED}),(()=>{if(null==document.querySelector("#"+m)){let e=document.querySelector("body"),r=document.querySelector("#content"),t=document.createElement("div");t.id=m,t.style="position: fixed; right: 0;user-select: none; padding: 5px; background: var(--navbar-bg-color); z-index:90; border: solid 1px var(--navbar-separator); text-align: right; transition width 1s";let n=document.createElement("span");n.innerHTML="Ylilauta Thread Hider v"+h.runtime.getManifest().version,n.style="font-size: 0.7em",t.appendChild(n),e.insertBefore(t,r)}})(),(()=>{if(null==document.querySelector("#"+l)){let e=document.createElement("div");e.id=l,e.style="height: 100%; font-size: 0.9em !important; cursor: pointer;display:inline; border: solid 1px var(--navbar-separator); border-bottom: 0; border-top: 0; padding: 6px; margin: 0 6px;";let r=document.createElement("a");r.href=E.runtime.getURL("options.html"),r.target="_blank";let t=document.createElement("img");t.src=E.runtime.getURL("/img/settings.svg"),t.style="width:15px;filter: invert() grayscale(1)",r.appendChild(t),e.appendChild(r),document.querySelector("#"+m).prepend(e)}})(),(()=>{if(null==document.querySelector("#"+c)){let e=document.querySelector("#content"),r=document.createElement("div");r.innerHTML="Odota, lankoja ladataan ..",r.id=c,r.style="display: none; background-color: red; width: 100vw; text-align: center;!important; height: 20px; font-size: 0.9em !important; padding-left: 6px !important;top: 150px; left: 0px; transition: left 0.3s ease-out, top 0.3s ease-out, width 0.1s cubic-bezier(1,.01,.46,1.01), height 0.1s cubic-bezier(1,.01,0.3,.1); white-space: nowrap; overflow-x: hidden;",e.insertBefore(r,document.querySelector(".pagination")),e.appendChild(r)}})(),(()=>{let e=[];H.subscribe(i.SHOW_UNREAD_MESSAGE,(r=>{(()=>{if(null==document.querySelector("#"+d)){let r=document.createElement("div");r.id=d,r.style="height: 600px; width: 600px; position:fixed; margin: 0 auto; z-index:99; font-size: 0.9em !important;cursor: pointer;display:inline; border: solid 1px var(--navbar-separator); border-bottom: 0; border-top: 0; padding: 6px;background:green;",r.innerHTML="Hello, this is a MESSAGE";let t=document.createElement("div");t.id=A,r.appendChild(t),t=document.createElement("div"),t.id=u,r.appendChild(t);let n=document.createElement("button");n.innerText="Close me",n.onclick=()=>{r.remove(),H.publish(i.MARK_MESSAGE_AS_READ,e)},r.appendChild(n),document.querySelector("body").prepend(r)}})();let t=document.querySelector(1==r.priority?"#"+A:"#"+u),n=document.createElement("div");n.innerHTML=r.message,e.push(r.id),t.appendChild(n)}))})(),(()=>{if(!L().keyboardShortcutEnabled)return;let e=-1,r=-1;function t(e,r){return!(e.x+e.width<0||e.y+e.height<0)&&!(e.x>window.innerWidth||e.y>window.innerHeight)&&e.left+e.width>r.left&&e.left<r.left&&e.top+e.height>r.top&&e.top<r.top}document.onmousemove=function(t){e=t.pageX,r=t.pageY},document.addEventListener("keydown",(function(n){72==n.keyCode&&"textarea"!=document.activeElement.type&&"text"!=document.activeElement.type&&(n.preventDefault(),function(e,r){for(let n of[...document.querySelectorAll(".thread")])if(t(n.getBoundingClientRect(),{top:r-self.pageYOffset,left:e-self.pageXOffset})){const e=n.querySelector(".icon-minus");B(e,e.getAttribute("data-id"));break}}(e,r))}),!1)})(),(()=>{let e=1==L().hidingDisabled;if(null==document.querySelector("#"+g)){let r=document.createElement("span");r.innerHTML="ON",r.id=g,r.style="flex-grow: 0;font-size: 0.9em !important; cursor: pointer; padding: 0px 8px; display:inline-block; vertical-align:bottom; white-space:nowrap; width:36px;text-align:left;",r.onclick=function(){!function(){let r=document.querySelectorAll(".thread");const t=e?"hiddenThread":"visibleHiddenThread",n=e?"visibleHiddenThread":"hiddenThread";for(let e of r)e.classList.contains(n)&&(e.classList.remove(n),e.classList.add(t));e=!e,x(e),$("hidingDisabled",e)}()},r.target="_blank",document.querySelector("#"+m).prepend(r),x(e)}})(),(()=>{if(!L().cachingEnabled||null==document.querySelector(".grid"))return;window.onscroll=function(e){window.innerHeight+window.scrollY+5>=document.body.offsetHeight&&y()};const e=document.querySelector(".threads");new MutationObserver((function(){e.childElementCount-document.querySelectorAll(".hiddenThread").length<10&&k()&&(y(),P(!1)),e.childElementCount-document.querySelectorAll(".hiddenThread").length>10&&!k()&&P(!0)})).observe(e,{attributes:!0,childList:!0,subtree:!0})})()}),500),T.runtime.onMessage.addListener((e=>{const r=e.type,t=e.payload;switch(r){case a.NAH_YOU_LEGIT_BRO:T.runtime.sendMessage({type:s.ASK_FOR_MESSAGES}),T.runtime.sendMessage({type:s.THREADS,payload:z(O,null)});break;case a.YOU_A_SPAWN_BRO:T.runtime.sendMessage({type:s.SEND_THREADS_TO_ANOTHER_TAB,payload:{threads:z(O,t.masterTabId),page:window.location.toString().substring(window.location.toString().length-2,window.location.toString().length-1)}});break;case a.THREAD_FROM_OTHER_PAGE:D=!1,document.querySelector("#"+c).classList.remove("loaderVisible"),(e=>{try{const r=e.upvoteCount,t=e.downvoteCount,n=e.threadId,s=e.replyCount,a=e.postTime,o=(e.postId,document.querySelector(".threads"));let i;for(let e=0;e<document.querySelectorAll(".thread").length&&(i=document.querySelectorAll(".thread")[e],null==i.querySelector("img")||null==i.getElementsByClassName("post-vote upvote")[0]||null==i.getElementsByClassName("post-vote downvote")[0]);e++);i.classList.remove("gold"),i.classList.remove("gold-received"),i.classList.remove("admin"),i.classList.remove("hiddenThread"),i.classList.remove("visibleHiddenThread"),i=i.cloneNode(!0),null!=i.querySelector(".icon-pushpin")&&i.querySelector(".icon-pushpin").remove();const l=n;let g=i.querySelector("a").href.split("/");g.pop(),g=g.join("/")+"/"+l,i.setAttribute("data-id",l),i.querySelector("a").setAttribute("data-id",l),i.querySelector("a").href=g,p(i.getElementsByClassName("post-vote upvote")[0]),null!=r&&(i.getElementsByClassName("post-vote upvote")[0].innerHTML+=r),p(i.getElementsByClassName("post-vote downvote")[0]),null!=t&&(i.getElementsByClassName("post-vote downvote")[0].innerHTML+=t),i.querySelector(".icon-minus").setAttribute("data-id",l);let m=i.querySelector(".thread-meta").firstElementChild.innerHTML;i.querySelector(".thread-meta").firstElementChild.innerHTML=m.replace(/\d+$/,s),i.querySelector(".thread-meta").lastElementChild.innerHTML=a,i.querySelector("img").src=e.imageUrl,i.querySelector("img").srcset=e.imageUrl+" 1x, "+e.imageUrl+" 2x, "+e.imageUrl+" 3x";try{i.querySelectorAll("img")[1].src=e.imageUrl,i.querySelectorAll("img")[1].srcset=e.imageUrl+" 1x, "+e.imageUrl+" 2x, "+e.imageUrl+" 3x"}catch(e){}i.querySelector(".message").innerText=e.message,i.querySelector(".icon-minus").addEventListener("click",j),o.appendChild(i),I.hasOwnProperty(n)||N(n,i)}catch(e){console.log(e)}})(t);break;case a.INIT_COMPLETE:console.log("Init complete.");break;case a.FAILED_THREAD:H.publish(i.HIDE_THREAD,t);break;case a.WHITELISTED_THREAD:H.publish(i.WHITELIST_THREAD,t);break;case a.UNREAD_MESSAGE:H.publish(i.SHOW_UNREAD_MESSAGE,t);break;default:console.error(e)}})),H.subscribe(i.HIDE_THREAD,(e=>{const r=w.length;void 0!==e&&(w.push(e),r||(async()=>{for(;await W(),w.length;){let e=w.shift();for(;void 0===e&&w.length;)e=w.shift();if(void 0===e&&!w.length)break;const r=e,t=r.id,n=r.reason,s=r.message;try{let e=v[t].querySelector(".icon-minus");R.hidingDisabled?e.parentNode.parentNode.classList.add("visibleHiddenThread"):e.parentNode.parentNode.classList.add("hiddenThread")}catch(e){console.log(e)}console.log("Hidden ("+n+"): "+t+" >"+s)}})())})),H.subscribe(i.WHITELIST_THREAD,(e=>{const r=e.id,t=e.reason,n=e.message;v[r].classList.add("whitelistedThread"),console.log("Whitelisted ("+t+"): "+r+" >"+n)})),H.subscribe(i.MARK_MESSAGE_AS_READ,(e=>{e.map((e=>{T.runtime.sendMessage({type:s.MARK_MESSAGE_AS_READ,payload:e})}))})),console.log("Ylilauta Thread Hider Addon content script loaded"),(e=>{const r=document.createElement("style");r.textContent='\n  .hiddenThread {\n    display: none !important;\n  }\n  .visibleHiddenThread {\n    display: block !important;\n    border: solid 2px red !important;\n  }\n  .threadHiderDisabled {\n    color: red !important;\n  }\n  .whitelistedThread {\n    border: solid 2px green !important;\n  }\n  .loaderVisible {\n    display: block !important;\n  }\n  .switch {\n  position: relative;\n  display: inline-block;\n  width: 60px;\n  height: 34px;\n}\n\n.switch input { \n  opacity: 0;\n  width: 0;\n  height: 0;\n}\n\n.slider {\n  position: absolute;\n  cursor: pointer;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  background-color: #ccc;\n  -webkit-transition: .4s;\n  transition: .4s;\n}\n\n.slider:before {\n  position: absolute;\n  content: "";\n  height: 26px;\n  width: 26px;\n  left: 4px;\n  bottom: 4px;\n  background-color: white;\n  -webkit-transition: .4s;\n  transition: .4s;\n}\n\ninput:checked + .slider {\n  background-color: #2196F3;\n}\n\ninput:focus + .slider {\n  box-shadow: 0 0 1px #2196F3;\n}\n\ninput:checked + .slider:before {\n  -webkit-transform: translateX(26px);\n  -ms-transform: translateX(26px);\n  transform: translateX(26px);\n}\n\n/* Rounded sliders */\n.slider.round {\n  border-radius: 34px;\n}\n\n.slider.round:before {\n  border-radius: 50%;\n}\n',document.head.append(r)})()})()})();